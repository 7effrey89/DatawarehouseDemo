{
	"name": "fctSalesOrder",
	"properties": {
		"folder": {
			"name": "JDEE1/Facts"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "SnowFlakeDataset_dimFctTable",
						"type": "DatasetReference"
					},
					"name": "dimProduct"
				},
				{
					"dataset": {
						"referenceName": "SnowFlakeDataset_dimFctTable",
						"type": "DatasetReference"
					},
					"name": "dimCustomer"
				},
				{
					"dataset": {
						"referenceName": "SnowFlakeDataset_SrcTable",
						"type": "DatasetReference"
					},
					"name": "vSalesOrderDetailFile"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SnowFlakeDataset_dimFctTable",
						"type": "DatasetReference"
					},
					"name": "fctSALESORDER"
				}
			],
			"transformations": [
				{
					"name": "JoinProduct"
				},
				{
					"name": "JoinShipCustomer"
				},
				{
					"name": "ADDRESSNUMBERSHIPTO"
				},
				{
					"name": "ADDRESSNUMBER"
				},
				{
					"name": "JoinBillCustomer"
				},
				{
					"name": "Transformation"
				},
				{
					"name": "Product"
				},
				{
					"name": "columnFilter"
				},
				{
					"name": "RenameColumnNames"
				},
				{
					"name": "filterAwayNulls",
					"description": "I identified the dimension Customer was wwas filtering away certain customerID keys needed for this fact. The fact didn't allow nulls so using this to continue\n"
				}
			],
			"scriptLines": [
				"source(output(",
				"          SK_DIMPRODUCT as decimal(38,0),",
				"          PRODUCTID as string,",
				"          SHORTITEMID as decimal(8,0),",
				"          PRODUCT as string,",
				"          SECONDPRODUCT as string,",
				"          SEARCHTEXT as string,",
				"          ISACTIVE as string,",
				"          STOCKTYPE as string,",
				"          UOMPRIMARYID as string,",
				"          UOMSECONDARYID as string,",
				"          MANUFACTURINGFAMILYUOMID as string,",
				"          GLCLASS as string,",
				"          DISPATCHGROUPID as string,",
				"          PRODUCTTYPEID as string,",
				"          PRODUCTTYPE as string,",
				"          STRATEGICCATEGORY as string,",
				"          ISSTERILE as string,",
				"          COMMODITYCLASSID as string,",
				"          COMMODITYCLASS as string,",
				"          ACTIVEINGREDIENTID as string,",
				"          ACTIVEINGREDIENT as string,",
				"          MANUFACTURINGFAMILYID as string,",
				"          MANUFACTURINGFAMILY as string,",
				"          QUALITYGROUPID as string,",
				"          QUALITYGROUP as string,",
				"          MASTERPLANNINGFAMILYID as string,",
				"          MASTERPLANNINGFAMILY as string,",
				"          PRODUCTFILTER as decimal(38,0),",
				"          QUALITYGROUPFILTER as decimal(38,0),",
				"          STOCKINGTYPEFILTER as decimal(38,0),",
				"          COMMODITYCLASSFILTER as decimal(38,0),",
				"          ACTUALSFILTER as decimal(38,0),",
				"          PLANNINGFILTER as decimal(38,0),",
				"          LAST_UPDATED_TS as timestamp,",
				"          SRC_DELETED_FLG as string,",
				"          CREATED_DATETIME as timestamp,",
				"          CREATED_BY as string,",
				"          UPDATED_DATETIME as timestamp,",
				"          UPDATED_BY as string,",
				"          ACTIVE_IND as string,",
				"          EFFECTIVE_START_DATE as date,",
				"          EFFECTIVE_END_DATE as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table') ~> dimProduct",
				"source(output(",
				"          SK_DIMCUSTOMER as decimal(38,0),",
				"          CUSTOMERID as decimal(8,0),",
				"          CUSTOMER as string,",
				"          COSTCENTERID as string,",
				"          MNEMONICID as string,",
				"          HIERARCHYFILTER as decimal(38,0),",
				"          SHIPTOFILTER as decimal(38,0),",
				"          BUSINESSUNITFILTER as decimal(38,0),",
				"          SALESMANAGERFILTER as decimal(38,0),",
				"          SEARCHTYPEID as string,",
				"          SEARCHTYPE as string,",
				"          TERRITORYID as string,",
				"          PBCSCUSTOMERID as string,",
				"          HIERARCHYCHECKID as string,",
				"          HIERARCHYCHECK as string,",
				"          MANUFACTURINGTYPE as string,",
				"          CUSTOMERCLASS as string,",
				"          SALESTYPE as string,",
				"          CONTRACTCODE as string,",
				"          CUSTOMERTYPEID as string,",
				"          CUSTOMERTYPE as string,",
				"          CUSTOMERCODEID as string,",
				"          CUSTOMERCODE as string,",
				"          SALESMANAGERID as string,",
				"          SALESMANAGER as string,",
				"          SALESMANAGERREGION as string,",
				"          CUSTOMERAGGRLEVELID as string,",
				"          CUSTOMERAGGRLEVEL as string,",
				"          PLANNINGLEVELID as string,",
				"          PLANNINGLEVEL as string,",
				"          CORPORATECODEID as string,",
				"          CORPORATECODE as string,",
				"          ACTUALSFILTER as decimal(38,0),",
				"          PLANNINGFILTER as decimal(38,0),",
				"          LAST_UPDATED_TS as timestamp,",
				"          SRC_DELETED_FLG as string,",
				"          CREATED_DATETIME as timestamp,",
				"          CREATED_BY as string,",
				"          UPDATED_DATETIME as timestamp,",
				"          UPDATED_BY as string,",
				"          ACTIVE_IND as string,",
				"          EFFECTIVE_START_DATE as date,",
				"          EFFECTIVE_END_DATE as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table') ~> dimCustomer",
				"source(output(",
				"          CODELOCATIONTAXSTAT as string,",
				"          SUBLEDGERTYPE as string,",
				"          SUBLEDGER as string,",
				"          UNITOFMEASUREGROSSWT as string,",
				"          GROSSWEIGHT as decimal(21,6),",
				"          REASONCODE as string,",
				"          COMMISSIONCATEGORY as string,",
				"          APPLYCOMMISSIONYN as string,",
				"          SALESORDERSTATUS15 as string,",
				"          SALESORDERSTATUS14 as string,",
				"          SALESORDERSTATUS13 as string,",
				"          SALESORDERSTATUS12 as string,",
				"          SALESORDERSTATUS11 as string,",
				"          SALESORDERSTATUS10 as string,",
				"          SALESORDERSTATUS09 as string,",
				"          SALESORDERSTATUS08 as string,",
				"          SALESORDERSTATUS07 as string,",
				"          SALESORDERSTATUS06 as string,",
				"          SALESORDERSTATUS05 as string,",
				"          SALESORDERSTATUS04 as string,",
				"          SALESORDERSTATUS03 as string,",
				"          SALESORDERSTATUS02 as string,",
				"          SALESORDERSTATUS01 as string,",
				"          FISCALYEAR1 as decimal(2,0),",
				"          CENTURY as decimal(2,0),",
				"          GLCLASS as string,",
				"          INVENTORYCOSTINGMETH as string,",
				"          ORDERREPRICEDINDICATOR as string,",
				"          ORDERREPRICECATEGORY as string,",
				"          REPRICEBASKETPRICECAT as string,",
				"          VOLUMEUNITOFMEASURE as string,",
				"          AMOUNTUNITVOLUME as decimal(21,6),",
				"          WEIGHTUNITOFMEASURE as string,",
				"          AMOUNTUNITWEIGHT as decimal(21,6),",
				"          UNITOFMEASUREPRICING as string,",
				"          UNITSSECONDARYQTYOR as decimal(21,6),",
				"          UNITOFMEASURESECONDARY as string,",
				"          UNITSPRIMARYQTYORDER as decimal(21,6),",
				"          UNITOFMEASUREPRIMARY as string,",
				"          SERIALNUMBERLOT as string,",
				"          SHIPPINGCONDITIONSCODE as string,",
				"          SHIPPINGCOMMODITYCLASS as string,",
				"          FREIGHTHANDLINGCODE as string,",
				"          CONTAINERID as string,",
				"          ZONENUMBER as string,",
				"          STOPCODE as string,",
				"          ROUTECODE as string,",
				"          MODEOFTRANSPORT as string,",
				"          CARRIER as decimal(8,0),",
				"          PRIMARYLASTVENDORNO as decimal(8,0),",
				"          NATUREOFTRANSACTION as string,",
				"          DUTYSTATUS as string,",
				"          ENDUSE as string,",
				"          LINEOFBUSINESS as string,",
				"          PARTIALSHIPMNTSALLOWY as string,",
				"          SUBSTITUTESALLOWEDYN as string,",
				"          BACKORDERSALLOWEDYN as string,",
				"          RESOLUTIONCODEBC as string,",
				"          PRIORITYPROCESSING as string,",
				"          ASSOCIATEDTEXT as string,",
				"          TAXEXPLANATIONCODE1 as string,",
				"          TAXAREA1 as string,",
				"          TAXABLEYN as string,",
				"          DELIVERYNUMBER as decimal(8,0),",
				"          PICKSLIPNUMBER as decimal(8,0),",
				"          DOCUMENTCOMPANYORIGINAL as string,",
				"          ORIGINALDOCUMENTTYPE as string,",
				"          ORIGINALDOCUMENTNO as decimal(8,0),",
				"          DOCUMENTTYPE as string,",
				"          DOCVOUCHERINVOICEE as decimal(8,0),",
				"          COMPANYKEY as string,",
				"          DISCOUNTCASH as decimal(13,6),",
				"          PRICINGCATEGORYLEVEL1 as string,",
				"          PRICINGCATEGORY as string,",
				"          PRICEADJUSTMENTSCHEDULEN as string,",
				"          TRADEDISCOUNTOLD as decimal(21,6),",
				"          DISCOUNTTRADE as decimal(13,6),",
				"          BASEDONDATE as string,",
				"          PAYMENTINSTRUMENTA as string,",
				"          PAYMENTTERMSCODE01 as string,",
				"          PRINTMESSAGE1 as string,",
				"          EXTENDEDCOSTTRANSFER as decimal(21,6),",
				"          COSTOVERRIDECODE as string,",
				"          AMOUNTEXTENDEDCOST as decimal(21,6),",
				"          AMOUNTUNITCOST as decimal(21,6),",
				"          AMTLISTPRICEPERUNIT as decimal(21,6),",
				"          UNITOFMEASUREENTUP as string,",
				"          TEMPORARYPRICEYN as string,",
				"          PRICEOVERRIDECODE as string,",
				"          AMOUNTOPEN1 as decimal(21,6),",
				"          AMOUNTEXTENDEDPRICE as decimal(21,6),",
				"          AMTPRICEPERUNIT2 as decimal(22,6),",
				"          OTHERQUANTITY12 as string,",
				"          COMMITTEDHS as string,",
				"          QUANTITYRELIEVED as decimal(21,6),",
				"          QUANTITYSHIPPEDTODATE as decimal(21,6),",
				"          UNITSOPENQUANTITY as decimal(21,6),",
				"          UNITSQUANTITYFUTURE as decimal(21,6),",
				"          UNITSQUANTITYCANCELED as decimal(21,6),",
				"          UNITSQUANBACKORHELD as decimal(21,6),",
				"          UNITSQUANTITYSHIPPED as decimal(15,0),",
				"          UNITSTRANSACTIONQTY as decimal(21,6),",
				"          UNITOFMEASUREASINPUT as string,",
				"          PURCHASINGREPORTCODE5 as string,",
				"          PURCHASINGREPORTCODE4 as string,",
				"          PURCHASINGREPORTCODE3 as string,",
				"          PURCHASINGREPORTCODE2 as string,",
				"          PURCHASINGREPORTCODE1 as string,",
				"          SALESREPORTINGCODE5 as string,",
				"          SALESREPORTINGCODE4 as string,",
				"          SALESREPORTINGCODE3 as string,",
				"          SALESREPORTINGCODE2 as string,",
				"          SALESREPORTINGCODE1 as string,",
				"          NUMBOFCPNTPERPARENT as decimal(21,6),",
				"          RELATEDKITCOMPONENT as decimal(8,0),",
				"          COMPONENTNUMBER as decimal(10,6),",
				"          LINENUMBERKITMASTER as decimal(12,6),",
				"          ITEMNUMBERRELATEDKIT as string,",
				"          COSTCENTERHEADER as string,",
				"          STATUSCODELAST as string,",
				"          PRODUCTIONNUMBERSHORT as decimal(10,0),",
				"          PRODUCTIONNUMBER as string,",
				"          OCKANBANCARDNO as decimal(8,0),",
				"          OCINTRANSITFLAG as string,",
				"          KITCOMPONENTDIRTYFLAG as string,",
				"          ACCUMULATEDAMOUNTINVOICEDFOREIGN as decimal(21,6),",
				"          ACCUMULATEDAMOUNTINVOICEDDOMESTIC as decimal(21,6),",
				"          KITIDENTIFIER as decimal(15,0),",
				"          CUSTOMERMASTERCOMPANY as string,",
				"          SCOREOVERRIDE as string,",
				"          ORDERSCORE as decimal(15,0),",
				"          ALLOCATIONSTATUS as string,",
				"          FULFILLMENTPLANID as decimal(10,0),",
				"          ALLOCATIONFLAG as string,",
				"          CATALOGNAME as string,",
				"          UNIQUEKEYIDINTERNAL as decimal(15,0),",
				"          ORGANIZATIONTYPESTRUCTUR as string,",
				"          OPPORTUNITYID as decimal(15,0),",
				"          SHIPTOCUSCONTACTLINENUMID as decimal(5,0),",
				"          CUSTOMERCONTACTLINENUMBERID as decimal(5,0),",
				"          PARTNERCONTACTLINENUMID as decimal(5,0),",
				"          PARTNERADDRESSNUMBER as decimal(8,0),",
				"          SHIPTOATTENTION as string,",
				"          PARENTNUMBER as decimal(8,0),",
				"          ASSETITEMNUMBER as decimal(8,0),",
				"          PROMOTIONID as string,",
				"          BUYERNUMBER as decimal(8,0),",
				"          PAYMENTTERMSOVERRIDE as string,",
				"          PORTOFENTRYEXIT as string,",
				"          CROSSDOCKORDERSUFFIX as string,",
				"          CROSSDOCKLINENUMBER as decimal(12,6),",
				"          CROSSDOCKORDERTYPE as string,",
				"          CROSSDOCKORDERNUMBER as decimal(8,0),",
				"          CROSSDOCKCMPYKEYORDERNO as string,",
				"          DATEORIGINALPROMISDE as decimal(18,0),",
				"          ORIGINALDOCUMENTLINENO as decimal(13,6),",
				"          CURRENCYCODEBASE as string,",
				"          BUSINESSUNITDEMAND as string,",
				"          BUSINESSUNITHEADER9 as string,",
				"          HOLDORDERSCODE as string,",
				"          MEREVISIONLEVEL as string,",
				"          SEQUENCENUMBER as decimal(4,0),",
				"          PROJECTNUMBER as decimal(8,0),",
				"          PROMISEDDELIVERYTIME as string,",
				"          SHIPMENTNUMBER as decimal(8,0),",
				"          MATRIXCONTROLLINE as decimal(12,6),",
				"          REVISIONREASON as string,",
				"          PENDINGAPPROVALFLAG as string,",
				"          ADDRESSNUMBERDELIVEREDTO as decimal(8,0),",
				"          NUMBERCHANGEORDER as decimal(3,0),",
				"          CURRENTBUYINGSEGMENTCODE as string,",
				"          BUYINGSEGMENTCODE as string,",
				"          DUALUNITOFMEASUREITEM as string,",
				"          CROSSDOCKINGPRIORITY as decimal(15,0),",
				"          CROSSDOCKFLAG as string,",
				"          TIMEFUTURE2 as string,",
				"          PROMISEDPICKTIME as string,",
				"          TIMEORIGINALPROMISED as string,",
				"          ACTUALSHIPMENTTIME as string,",
				"          REQUESTEDDELIVERYTIME as string,",
				"          DATERELEASE as decimal(18,0),",
				"          TIMERELEASE as string,",
				"          SCHEDULEDSHIPMENTTIME as string,",
				"          RELEASENUMBER as string,",
				"          PULLSIGNAL as string,",
				"          DEMANDUNIQUEKEY as decimal(15,0),",
				"          REFERENCEUCISNO as string,",
				"          SOURCEOFORDER as decimal(10,0),",
				"          INTEGRATIONREFERENCE05 as string,",
				"          INTEGRATIONREFERENCE04 as string,",
				"          INTEGRATIONREFERENCE03 as string,",
				"          INTEGRATIONREFERENCE02 as string,",
				"          INTEGRATIONREFERENCE01 as string,",
				"          SALESORDERSTATUS20 as string,",
				"          SALESORDERSTATUS19 as string,",
				"          SALESORDERSTATUS18 as string,",
				"          SALESORDERSTATUS17 as string,",
				"          SALESORDERSTATUS16 as string,",
				"          TIMEOFDAY as string,",
				"          DATEUPDATED as decimal(18,0),",
				"          WORKSTATIONID as string,",
				"          PROGRAMID as string,",
				"          USERID as string,",
				"          TRANSACTIONORIGINATOR as string,",
				"          USERRESERVEDREFERENCE as string,",
				"          USERRESERVEDNUMBER as decimal(8,0),",
				"          USERRESERVEDAMOUNT as decimal(21,6),",
				"          USERRESERVEDDATE as decimal(18,0),",
				"          USERRESERVEDCODE as string,",
				"          AMOUNTFOREIGNEXTCOST as decimal(21,6),",
				"          AMOUNTFOREIGNUNITCOST as decimal(21,6),",
				"          AMOUNTFOREIGNEXTPRICE as decimal(21,6),",
				"          AMTFORPRICEPERUNIT as decimal(21,6),",
				"          AMOUNTLISTPRICEFOREIGN as decimal(21,6),",
				"          CURRENCYCONVERRATEOV as decimal(15,7),",
				"          CURRENCYCODEFROM as string,",
				"          CORRESPONDENCEMETHOD as string,",
				"          WOORDERFREEZECODE as string,",
				"          STATUSINWAREHOUSE as string,",
				"          PRICECODE3 as string,",
				"          PRICECODE2 as string,",
				"          PRICECODE1 as string,",
				"          STATUSCODENEXT as string,",
				"          LINETYPE as string,",
				"          DESCRIPTIONLINE2 as string,",
				"          DESCRIPTIONLINE1 as string,",
				"          DAYSPASTEXPIRATION as decimal(5,0),",
				"          THRUPOTENCY as decimal(13,6),",
				"          FROMPOTENCY as decimal(13,6),",
				"          THRUGRADE as string,",
				"          FROMGRADE as string,",
				"          LOT as string,",
				"          LOCATION as string,",
				"          IDENTIFIER3RDITEM as string,",
				"          IDENTIFIER2NDITEM as string,",
				"          IDENTIFIERSHORTITEM as decimal(8,0),",
				"          REFERENCE2VENDOR as string,",
				"          REFERENCE1 as string,",
				"          DATEPROMISEDSHIPJU as decimal(18,0),",
				"          DATEPRICEEFFECTIVEDATE as decimal(18,0),",
				"          DATERELEASEJULIAN as decimal(18,0),",
				"          DTFORGLANDVOUCH1 as decimal(18,0),",
				"          CANCELDATE as decimal(18,0),",
				"          DATEINVOICEJULIAN as decimal(18,0),",
				"          ACTUALSHIPDATE as decimal(18,0),",
				"          SCHEDULEDPICKDATE as decimal(18,0),",
				"          DATETRANSACTIONJULIAN as decimal(18,0),",
				"          DATEREQUESTEDJULIAN as decimal(18,0),",
				"          ADDRESSNUMBERPARENT as decimal(8,0),",
				"          ADDRESSNUMBERSHIPTO as decimal(8,0),",
				"          ADDRESSNUMBER as decimal(8,0),",
				"          CONTRACTSUPPLEMENTDISTRI as decimal(3,0),",
				"          CONTRACTNUMBERDISTRIBUTI as string,",
				"          RELATEDPOSOLINENO as decimal(13,6),",
				"          RELATEDORDERTYPE as string,",
				"          RELATEDPOSONUMBER as string,",
				"          COMPANYKEYRELATED as string,",
				"          ORIGINALLINENUMBER as decimal(13,6),",
				"          ORIGINALORDERTYPE as string,",
				"          ORIGINALPOSONUMBER as string,",
				"          COMPANYKEYORIGINAL as string,",
				"          COMPANY as string,",
				"          COSTCENTER as string,",
				"          ORDERSUFFIX as string,",
				"          LINENUMBER as decimal(6,0),",
				"          ORDERTYPE as string,",
				"          {__IQ4BIS_PARTITIONKEY} as double,",
				"          COMPANYKEYORDERNO as string,",
				"          DOCUMENTORDERINVOICEE as double,",
				"          COMPANYKEYORDERNO_TRIM as string,",
				"          DOCUMENTORDERINVOICEE_TRIM as string,",
				"          LINENUMBER_TRIM as string,",
				"          ORDERTYPE_TRIM as string,",
				"          ACTUALSHIPDATE_DATE as date,",
				"          CANCELDATE_DATE as date,",
				"          DATEINVOICEJULIAN_DATE as date,",
				"          DATEORIGINALPROMISDE_DATE as date,",
				"          DATEPRICEEFFECTIVEDATE_DATE as date,",
				"          DATEPROMISEDSHIPJU_DATE as date,",
				"          DATERELEASE_DATE as date,",
				"          DATERELEASEJULIAN_DATE as date,",
				"          DATEREQUESTEDJULIAN_DATE as date,",
				"          DATETRANSACTIONJULIAN_DATE as date,",
				"          DATEUPDATED_DATE as date,",
				"          DTFORGLANDVOUCH1_DATE as date,",
				"          SCHEDULEDPICKDATE_DATE as date,",
				"          USERRESERVEDDATE_DATE as date,",
				"          ACTUALSHIPDATE_YM as string,",
				"          CANCELDATE_YM as string,",
				"          DATEINVOICEJULIAN_YM as string,",
				"          DATEORIGINALPROMISDE_YM as string,",
				"          DATEPRICEEFFECTIVEDATE_YM as string,",
				"          DATEPROMISEDSHIPJU_YM as string,",
				"          DATERELEASE_YM as string,",
				"          DATERELEASEJULIAN_YM as string,",
				"          DATEREQUESTEDJULIAN_YM as string,",
				"          DATETRANSACTIONJULIAN_YM as string,",
				"          DATEUPDATED_YM as string,",
				"          DTFORGLANDVOUCH1_YM as string,",
				"          SCHEDULEDPICKDATE_YM as string,",
				"          USERRESERVEDDATE_YM as string,",
				"          SRC_DELETED_FLG as string,",
				"          LAST_UPDATED_TS as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table') ~> vSalesOrderDetailFile",
				"columnFilter, Product join(IDENTIFIER2NDITEM == PRODUCTID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinProduct",
				"JoinProduct, ADDRESSNUMBERSHIPTO join(ADDRESSNUMBERSHIPTO == CUSTOMERID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinShipCustomer",
				"dimCustomer select(mapColumn(",
				"          SK_DIMCUSTOMER,",
				"          CUSTOMERID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> ADDRESSNUMBERSHIPTO",
				"dimCustomer select(mapColumn(",
				"          SK_DIMCUSTOMER,",
				"          CUSTOMERID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> ADDRESSNUMBER",
				"JoinShipCustomer, ADDRESSNUMBER join(ADDRESSNUMBER == ADDRESSNUMBER@CUSTOMERID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinBillCustomer",
				"JoinBillCustomer derive(SALESORDERID = concat(toString(DOCUMENTORDERINVOICEE),ORDERTYPE,COMPANYKEYORDERNO),",
				"          SALESORDERLINEID = concat(toString(DOCUMENTORDERINVOICEE),ORDERTYPE,COMPANYKEYORDERNO,toString(LINENUMBER)),",
				"          TRANSACTIONPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATETRANSACTIONJULIAN_DATE),1),-1),",
				"          REQUESTPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATEREQUESTEDJULIAN_DATE),1),-1),",
				"          DELIVERYPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATERELEASEJULIAN_DATE),1),-1),",
				"          SHIPMENTPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATEPROMISEDSHIPJU_DATE),1),-1),",
				"          INVOICEPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATEINVOICEJULIAN_DATE),1),-1),",
				"          GLPERIODDATEID = addMonths(addDays(lastDayOfMonth(DTFORGLANDVOUCH1_DATE),1),-1),",
				"          ISSAMPLE = iif(   UNITSQUANTITYSHIPPED > 0    && AMOUNTEXTENDEDPRICE == 0    && AMOUNTFOREIGNEXTPRICE == 0    , 1   , 0 ),",
				"          ISQUANTITYFIX = iif(   LINETYPE == 'N'    || LINETYPE == 'CB'    || LINETYPE == 'DB'   , 1   , 0 ),",
				"          each(match(right(name, 11)=='JULIAN_DATE' || right(name, 11)=='SHIPJU_DATE'), concat($$, '_awesome') = addMonths(addDays(lastDayOfMonth($$),1),-1))) ~> Transformation",
				"dimProduct select(mapColumn(",
				"          SK_DIMPRODUCT,",
				"          PRODUCTID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Product",
				"vSalesOrderDetailFile select(mapColumn(",
				"          each(match(in(['LAST_UPDATED_TS','SRC_DELETED_FLG','AMTPRICEPERUNIT2','AMOUNTEXTENDEDPRICE','DATETRANSACTIONJULIAN_DATE','AMOUNTEXTENDEDCOST','AMTFORPRICEPERUNIT','AMOUNTFOREIGNEXTPRICE','AMOUNTFOREIGNEXTCOST','UNITSTRANSACTIONQTY','UNITSPRIMARYQTYORDER','UNITSSECONDARYQTYOR','UNITSQUANTITYSHIPPED','LINETYPE','STATUSCODENEXT','HOLDORDERSCODE','UNITOFMEASUREASINPUT','UNITOFMEASUREPRIMARY','UNITOFMEASURESECONDARY','UNITOFMEASUREPRICING','CURRENCYCODEFROM','ADDRESSNUMBER','ADDRESSNUMBERSHIPTO','COSTCENTER','LOCATION','DTFORGLANDVOUCH1_DATE','DATERELEASEJULIAN_DATE','DATEPROMISEDSHIPJU_DATE','DATEINVOICEJULIAN_DATE','ATETRANSACTIONJULIAN_DATE','DATEREQUESTEDJULIAN_DATE','IDENTIFIER2NDITEM','ADDRESSNUMBERSHIPTO','ADDRESSNUMBER','DOCUMENTORDERINVOICEE','ORDERTYPE','COMPANYKEYORDERNO','LINENUMBER','AMOUNTFOREIGNEXTPRICE','AMOUNTEXTENDEDPRICE','UNITSQUANTITYSHIPPED','LINETYPE'],name)))",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> columnFilter",
				"Transformation select(mapColumn(",
				"          SK_DIMPRODUCT,",
				"          SK_SHIPTOCUSTOMERLEVELID = ADDRESSNUMBERSHIPTO@SK_DIMCUSTOMER,",
				"          SK_BILLTOCUSTOMERLEVELID = ADDRESSNUMBER@SK_DIMCUSTOMER,",
				"          SALESORDERID,",
				"          SALESORDERLINEID,",
				"          TRANSACTIONDATEID = DATETRANSACTIONJULIAN_DATE,",
				"          TRANSACTIONPERIODDATEID,",
				"          REQUESTDATEID = DATEREQUESTEDJULIAN_DATE,",
				"          REQUESTPERIODDATEID,",
				"          DELIVERYDATEID = DATERELEASEJULIAN_DATE,",
				"          DELIVERYPERIODDATEID,",
				"          SHIPMENTDATEID = DATEPROMISEDSHIPJU_DATE,",
				"          SHIPMENTPERIODDATEID,",
				"          INVOICEDATEID = DATEINVOICEJULIAN_DATE,",
				"          INVOICEPERIODDATEID,",
				"          GLDATEID = DTFORGLANDVOUCH1_DATE,",
				"          GLPERIODDATEID,",
				"          LINETYPEID = LINETYPE,",
				"          STATUSCODENEXTID = STATUSCODENEXT,",
				"          HOLDCODE = HOLDORDERSCODE,",
				"          ORDERUOMID = UNITOFMEASUREASINPUT,",
				"          PRIMARYUOMID = UNITOFMEASUREPRIMARY,",
				"          SECONDARYUOMID = UNITOFMEASURESECONDARY,",
				"          PRICINGUOMID = UNITOFMEASUREPRICING,",
				"          CURRENCYFOREIGNID = CURRENCYCODEFROM,",
				"          BILLTOCUSTOMERID = ADDRESSNUMBER,",
				"          SHIPTOCUSTOMERID = ADDRESSNUMBERSHIPTO,",
				"          BUSINESSUNITID = COSTCENTER,",
				"          LOCATIONID = LOCATION,",
				"          ISSAMPLE,",
				"          ISQUANTITYFIX,",
				"          UNITPRICEDOMESTIC = AMTPRICEPERUNIT2,",
				"          SALESPRICEDOMESTIC = AMOUNTEXTENDEDPRICE,",
				"          COGSDOMESTIC = AMOUNTEXTENDEDCOST,",
				"          UNITPRICEFOREIGN = AMTFORPRICEPERUNIT,",
				"          SALESPRICEFOREIGN = AMOUNTFOREIGNEXTPRICE,",
				"          COGSFOREIGN = AMOUNTFOREIGNEXTCOST,",
				"          ORDERQUANTITY = UNITSTRANSACTIONQTY,",
				"          ORDERQUANTITYPRIMARY = UNITSPRIMARYQTYORDER,",
				"          ORDERQUANTITYSECONDARY = UNITSSECONDARYQTYOR,",
				"          SHIPPEDQUANTITY = UNITSQUANTITYSHIPPED,",
				"          LAST_UPDATED_TS,",
				"          SRC_DELETED_FLG",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RenameColumnNames",
				"RenameColumnNames filter(!isNull(SK_DIMPRODUCT)&&!isNull(SK_SHIPTOCUSTOMERLEVELID)&&!isNull(SK_BILLTOCUSTOMERLEVELID)&&!isNull(SALESORDERID)&&!isNull(SALESORDERLINEID)) ~> filterAwayNulls",
				"filterAwayNulls sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     truncate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     stageInsert: true) ~> fctSALESORDER"
			]
		}
	}
}