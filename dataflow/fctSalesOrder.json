{
	"name": "fctSalesOrder",
	"properties": {
		"folder": {
			"name": "JDEE1/Facts"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AzureTable1",
						"type": "DatasetReference"
					},
					"name": "dimProduct"
				},
				{
					"dataset": {
						"referenceName": "AzureTable1",
						"type": "DatasetReference"
					},
					"name": "dimCustomer"
				},
				{
					"dataset": {
						"referenceName": "AzureTable1",
						"type": "DatasetReference"
					},
					"name": "vSalesOrderDetailFile"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureTable1",
						"type": "DatasetReference"
					},
					"name": "fctSALESORDER"
				}
			],
			"transformations": [
				{
					"name": "JoinProduct"
				},
				{
					"name": "JoinShipCustomer"
				},
				{
					"name": "ADDRESSNUMBERSHIPTO"
				},
				{
					"name": "ADDRESSNUMBER"
				},
				{
					"name": "JoinBillCustomer"
				},
				{
					"name": "Transformation"
				},
				{
					"name": "Product"
				},
				{
					"name": "columnFilter"
				},
				{
					"name": "RenameColumnNames"
				},
				{
					"name": "filterAwayNulls",
					"description": "I identified the dimension Customer was wwas filtering away certain customerID keys needed for this fact. The fact didn't allow nulls so using this to continue\n"
				}
			],
			"scriptLines": [
				"source(output(",
				"          SK_DIMPRODUCT as integer,",
				"          PRODUCTID as string,",
				"          SHORTITEMID as decimal(8,0),",
				"          PRODUCT as string,",
				"          SECONDPRODUCT as string,",
				"          SEARCHTEXT as string,",
				"          ISACTIVE as string,",
				"          STOCKTYPE as string,",
				"          UOMPRIMARYID as string,",
				"          UOMSECONDARYID as string,",
				"          MANUFACTURINGFAMILYUOMID as string,",
				"          GLCLASS as string,",
				"          DISPATCHGROUPID as string,",
				"          PRODUCTTYPEID as string,",
				"          PRODUCTTYPE as string,",
				"          STRATEGICCATEGORY as string,",
				"          ISSTERILE as string,",
				"          COMMODITYCLASSID as string,",
				"          COMMODITYCLASS as string,",
				"          ACTIVEINGREDIENTID as string,",
				"          ACTIVEINGREDIENT as string,",
				"          MANUFACTURINGFAMILYID as string,",
				"          MANUFACTURINGFAMILY as string,",
				"          QUALITYGROUPID as string,",
				"          QUALITYGROUP as string,",
				"          MASTERPLANNINGFAMILYID as string,",
				"          MASTERPLANNINGFAMILY as string,",
				"          PRODUCTFILTER as integer,",
				"          QUALITYGROUPFILTER as integer,",
				"          STOCKINGTYPEFILTER as integer,",
				"          COMMODITYCLASSFILTER as integer,",
				"          ACTUALSFILTER as integer,",
				"          PLANNINGFILTER as integer,",
				"          LAST_UPDATED_TS as timestamp,",
				"          SRC_DELETED_FLG as string,",
				"          CREATED_DATETIME as timestamp,",
				"          CREATED_BY as string,",
				"          UPDATED_DATETIME as timestamp,",
				"          UPDATED_BY as string,",
				"          ACTIVE_IND as string,",
				"          EFFECTIVE_START_DATE as date,",
				"          EFFECTIVE_END_DATE as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> dimProduct",
				"source(output(",
				"          SK_DIMCUSTOMER as integer,",
				"          CUSTOMERID as decimal(8,0),",
				"          CUSTOMER as string,",
				"          COSTCENTERID as string,",
				"          MNEMONICID as string,",
				"          HIERARCHYFILTER as integer,",
				"          SHIPTOFILTER as integer,",
				"          BUSINESSUNITFILTER as integer,",
				"          SALESMANAGERFILTER as integer,",
				"          SEARCHTYPEID as string,",
				"          SEARCHTYPE as string,",
				"          TERRITORYID as string,",
				"          PBCSCUSTOMERID as string,",
				"          HIERARCHYCHECKID as string,",
				"          HIERARCHYCHECK as string,",
				"          MANUFACTURINGTYPE as string,",
				"          CUSTOMERCLASS as string,",
				"          SALESTYPE as string,",
				"          CONTRACTCODE as string,",
				"          CUSTOMERTYPEID as string,",
				"          CUSTOMERTYPE as string,",
				"          CUSTOMERCODEID as string,",
				"          CUSTOMERCODE as string,",
				"          SALESMANAGERID as string,",
				"          SALESMANAGER as string,",
				"          SALESMANAGERREGION as string,",
				"          CUSTOMERAGGRLEVELID as string,",
				"          CUSTOMERAGGRLEVEL as string,",
				"          PLANNINGLEVELID as string,",
				"          PLANNINGLEVEL as string,",
				"          CORPORATECODEID as string,",
				"          CORPORATECODE as string,",
				"          ACTUALSFILTER as integer,",
				"          PLANNINGFILTER as integer,",
				"          LAST_UPDATED_TS as timestamp,",
				"          SRC_DELETED_FLG as string,",
				"          CREATED_DATETIME as timestamp,",
				"          CREATED_BY as string,",
				"          UPDATED_DATETIME as timestamp,",
				"          UPDATED_BY as string,",
				"          ACTIVE_IND as string,",
				"          EFFECTIVE_START_DATE as date,",
				"          EFFECTIVE_END_DATE as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> dimCustomer",
				"source(output(",
				"          CODELOCATIONTAXSTAT as string,",
				"          SUBLEDGERTYPE as string,",
				"          SUBLEDGER as string,",
				"          UNITOFMEASUREGROSSWT as string,",
				"          GROSSWEIGHT as decimal(21,10),",
				"          REASONCODE as string,",
				"          COMMISSIONCATEGORY as string,",
				"          APPLYCOMMISSIONYN as string,",
				"          SALESORDERSTATUS15 as string,",
				"          SALESORDERSTATUS14 as string,",
				"          SALESORDERSTATUS13 as string,",
				"          SALESORDERSTATUS12 as string,",
				"          SALESORDERSTATUS11 as string,",
				"          SALESORDERSTATUS10 as string,",
				"          SALESORDERSTATUS09 as string,",
				"          SALESORDERSTATUS08 as string,",
				"          SALESORDERSTATUS07 as string,",
				"          SALESORDERSTATUS06 as string,",
				"          SALESORDERSTATUS05 as string,",
				"          SALESORDERSTATUS04 as string,",
				"          SALESORDERSTATUS03 as string,",
				"          SALESORDERSTATUS02 as string,",
				"          SALESORDERSTATUS01 as string,",
				"          FISCALYEAR1 as integer,",
				"          CENTURY as integer,",
				"          GLCLASS as string,",
				"          INVENTORYCOSTINGMETH as string,",
				"          ORDERREPRICEDINDICATOR as string,",
				"          ORDERREPRICECATEGORY as string,",
				"          REPRICEBASKETPRICECAT as string,",
				"          VOLUMEUNITOFMEASURE as string,",
				"          AMOUNTUNITVOLUME as decimal(21,10),",
				"          WEIGHTUNITOFMEASURE as string,",
				"          AMOUNTUNITWEIGHT as decimal(21,10),",
				"          UNITOFMEASUREPRICING as string,",
				"          UNITSSECONDARYQTYOR as decimal(22,9),",
				"          UNITOFMEASURESECONDARY as string,",
				"          UNITSPRIMARYQTYORDER as decimal(22,9),",
				"          UNITOFMEASUREPRIMARY as string,",
				"          SERIALNUMBERLOT as string,",
				"          SHIPPINGCONDITIONSCODE as string,",
				"          SHIPPINGCOMMODITYCLASS as string,",
				"          FREIGHTHANDLINGCODE as string,",
				"          CONTAINERID as string,",
				"          ZONENUMBER as string,",
				"          STOPCODE as string,",
				"          ROUTECODE as string,",
				"          MODEOFTRANSPORT as string,",
				"          CARRIER as integer,",
				"          PRIMARYLASTVENDORNO as integer,",
				"          NATUREOFTRANSACTION as string,",
				"          DUTYSTATUS as string,",
				"          ENDUSE as string,",
				"          LINEOFBUSINESS as string,",
				"          PARTIALSHIPMNTSALLOWY as string,",
				"          SUBSTITUTESALLOWEDYN as string,",
				"          BACKORDERSALLOWEDYN as string,",
				"          RESOLUTIONCODEBC as string,",
				"          PRIORITYPROCESSING as string,",
				"          ASSOCIATEDTEXT as string,",
				"          TAXEXPLANATIONCODE1 as string,",
				"          TAXAREA1 as string,",
				"          TAXABLEYN as string,",
				"          DELIVERYNUMBER as integer,",
				"          PICKSLIPNUMBER as integer,",
				"          DOCUMENTCOMPANYORIGINAL as string,",
				"          ORIGINALDOCUMENTTYPE as string,",
				"          ORIGINALDOCUMENTNO as integer,",
				"          DOCUMENTTYPE as string,",
				"          DOCVOUCHERINVOICEE as integer,",
				"          COMPANYKEY as string,",
				"          DISCOUNTCASH as decimal(12,8),",
				"          PRICINGCATEGORYLEVEL1 as string,",
				"          PRICINGCATEGORY as string,",
				"          PRICEADJUSTMENTSCHEDULEN as string,",
				"          TRADEDISCOUNTOLD as decimal(21,10),",
				"          DISCOUNTTRADE as decimal(12,8),",
				"          BASEDONDATE as string,",
				"          PAYMENTINSTRUMENTA as string,",
				"          PAYMENTTERMSCODE01 as string,",
				"          PRINTMESSAGE1 as string,",
				"          EXTENDEDCOSTTRANSFER as decimal(21,10),",
				"          COSTOVERRIDECODE as string,",
				"          AMOUNTEXTENDEDCOST as decimal(19,6),",
				"          AMOUNTUNITCOST as decimal(21,10),",
				"          AMTLISTPRICEPERUNIT as decimal(21,10),",
				"          UNITOFMEASUREENTUP as string,",
				"          TEMPORARYPRICEYN as string,",
				"          PRICEOVERRIDECODE as string,",
				"          AMOUNTOPEN1 as decimal(19,6),",
				"          AMOUNTEXTENDEDPRICE as decimal(19,6),",
				"          AMTPRICEPERUNIT2 as decimal(21,10),",
				"          OTHERQUANTITY12 as string,",
				"          COMMITTEDHS as string,",
				"          QUANTITYRELIEVED as decimal(22,9),",
				"          QUANTITYSHIPPEDTODATE as decimal(22,9),",
				"          UNITSOPENQUANTITY as decimal(22,9),",
				"          UNITSQUANTITYFUTURE as decimal(22,9),",
				"          UNITSQUANTITYCANCELED as decimal(22,9),",
				"          UNITSQUANBACKORHELD as decimal(22,9),",
				"          UNITSQUANTITYSHIPPED as decimal(15,2),",
				"          UNITSTRANSACTIONQTY as decimal(22,9),",
				"          UNITOFMEASUREASINPUT as string,",
				"          PURCHASINGREPORTCODE5 as string,",
				"          PURCHASINGREPORTCODE4 as string,",
				"          PURCHASINGREPORTCODE3 as string,",
				"          PURCHASINGREPORTCODE2 as string,",
				"          PURCHASINGREPORTCODE1 as string,",
				"          SALESREPORTINGCODE5 as string,",
				"          SALESREPORTINGCODE4 as string,",
				"          SALESREPORTINGCODE3 as string,",
				"          SALESREPORTINGCODE2 as string,",
				"          SALESREPORTINGCODE1 as string,",
				"          NUMBOFCPNTPERPARENT as decimal(22,9),",
				"          RELATEDKITCOMPONENT as integer,",
				"          COMPONENTNUMBER as decimal(9,6),",
				"          LINENUMBERKITMASTER as decimal(11,8),",
				"          ITEMNUMBERRELATEDKIT as string,",
				"          COSTCENTERHEADER as string,",
				"          STATUSCODELAST as string,",
				"          PRODUCTIONNUMBERSHORT as integer,",
				"          PRODUCTIONNUMBER as string,",
				"          OCKANBANCARDNO as integer,",
				"          OCINTRANSITFLAG as string,",
				"          KITCOMPONENTDIRTYFLAG as string,",
				"          ACCUMULATEDAMOUNTINVOICEDFOREIGN as decimal(19,6),",
				"          ACCUMULATEDAMOUNTINVOICEDDOMESTIC as decimal(19,6),",
				"          KITIDENTIFIER as integer,",
				"          CUSTOMERMASTERCOMPANY as string,",
				"          SCOREOVERRIDE as string,",
				"          ORDERSCORE as decimal(15,3),",
				"          ALLOCATIONSTATUS as string,",
				"          FULFILLMENTPLANID as decimal(38,0),",
				"          ALLOCATIONFLAG as string,",
				"          CATALOGNAME as string,",
				"          UNIQUEKEYIDINTERNAL as integer,",
				"          ORGANIZATIONTYPESTRUCTUR as string,",
				"          OPPORTUNITYID as integer,",
				"          SHIPTOCUSCONTACTLINENUMID as integer,",
				"          CUSTOMERCONTACTLINENUMBERID as integer,",
				"          PARTNERCONTACTLINENUMID as integer,",
				"          PARTNERADDRESSNUMBER as integer,",
				"          SHIPTOATTENTION as string,",
				"          PARENTNUMBER as integer,",
				"          ASSETITEMNUMBER as integer,",
				"          PROMOTIONID as string,",
				"          BUYERNUMBER as integer,",
				"          PAYMENTTERMSOVERRIDE as string,",
				"          PORTOFENTRYEXIT as string,",
				"          CROSSDOCKORDERSUFFIX as string,",
				"          CROSSDOCKLINENUMBER as decimal(11,8),",
				"          CROSSDOCKORDERTYPE as string,",
				"          CROSSDOCKORDERNUMBER as integer,",
				"          CROSSDOCKCMPYKEYORDERNO as string,",
				"          DATEORIGINALPROMISDE as decimal(6,0),",
				"          ORIGINALDOCUMENTLINENO as decimal(12,8),",
				"          CURRENCYCODEBASE as string,",
				"          BUSINESSUNITDEMAND as string,",
				"          BUSINESSUNITHEADER9 as string,",
				"          HOLDORDERSCODE as string,",
				"          MEREVISIONLEVEL as string,",
				"          SEQUENCENUMBER as integer,",
				"          PROJECTNUMBER as integer,",
				"          PROMISEDDELIVERYTIME as timestamp,",
				"          SHIPMENTNUMBER as integer,",
				"          MATRIXCONTROLLINE as decimal(11,8),",
				"          REVISIONREASON as string,",
				"          PENDINGAPPROVALFLAG as string,",
				"          ADDRESSNUMBERDELIVEREDTO as integer,",
				"          NUMBERCHANGEORDER as integer,",
				"          CURRENTBUYINGSEGMENTCODE as string,",
				"          BUYINGSEGMENTCODE as string,",
				"          DUALUNITOFMEASUREITEM as string,",
				"          CROSSDOCKINGPRIORITY as integer,",
				"          CROSSDOCKFLAG as string,",
				"          TIMEFUTURE2 as timestamp,",
				"          PROMISEDPICKTIME as timestamp,",
				"          TIMEORIGINALPROMISED as timestamp,",
				"          ACTUALSHIPMENTTIME as timestamp,",
				"          REQUESTEDDELIVERYTIME as timestamp,",
				"          TIMERELEASE as timestamp,",
				"          SCHEDULEDSHIPMENTTIME as timestamp,",
				"          RELEASENUMBER as string,",
				"          PULLSIGNAL as string,",
				"          DEMANDUNIQUEKEY as integer,",
				"          REFERENCEUCISNO as string,",
				"          SOURCEOFORDER as decimal(38,0),",
				"          INTEGRATIONREFERENCE05 as string,",
				"          INTEGRATIONREFERENCE04 as string,",
				"          INTEGRATIONREFERENCE03 as string,",
				"          INTEGRATIONREFERENCE02 as string,",
				"          INTEGRATIONREFERENCE01 as string,",
				"          SALESORDERSTATUS20 as string,",
				"          SALESORDERSTATUS19 as string,",
				"          SALESORDERSTATUS18 as string,",
				"          SALESORDERSTATUS17 as string,",
				"          SALESORDERSTATUS16 as string,",
				"          TIMEOFDAY as timestamp,",
				"          DATEUPDATED as decimal(6,0),",
				"          WORKSTATIONID as string,",
				"          PROGRAMID as string,",
				"          USERID as string,",
				"          TRANSACTIONORIGINATOR as string,",
				"          USERRESERVEDREFERENCE as string,",
				"          USERRESERVEDNUMBER as integer,",
				"          USERRESERVEDAMOUNT as decimal(19,6),",
				"          USERRESERVEDDATE as decimal(6,0),",
				"          USERRESERVEDCODE as string,",
				"          AMOUNTFOREIGNEXTCOST as decimal(19,6),",
				"          AMOUNTFOREIGNUNITCOST as decimal(21,10),",
				"          AMOUNTFOREIGNEXTPRICE as decimal(19,6),",
				"          AMTFORPRICEPERUNIT as decimal(21,10),",
				"          AMOUNTLISTPRICEFOREIGN as decimal(21,10),",
				"          CURRENCYCONVERRATEOV as integer,",
				"          CURRENCYCODEFROM as string,",
				"          CORRESPONDENCEMETHOD as string,",
				"          WOORDERFREEZECODE as string,",
				"          STATUSINWAREHOUSE as string,",
				"          PRICECODE3 as string,",
				"          PRICECODE2 as string,",
				"          PRICECODE1 as string,",
				"          STATUSCODENEXT as string,",
				"          LINETYPE as string,",
				"          DESCRIPTIONLINE2 as string,",
				"          DESCRIPTIONLINE1 as string,",
				"          DAYSPASTEXPIRATION as integer,",
				"          THRUPOTENCY as decimal(12,8),",
				"          FROMPOTENCY as decimal(12,8),",
				"          THRUGRADE as string,",
				"          FROMGRADE as string,",
				"          LOT as string,",
				"          LOCATION as string,",
				"          IDENTIFIER3RDITEM as string,",
				"          IDENTIFIER2NDITEM as string,",
				"          IDENTIFIERSHORTITEM as integer,",
				"          REFERENCE2VENDOR as string,",
				"          REFERENCE1 as string,",
				"          DATEPROMISEDSHIPJU as decimal(6,0),",
				"          DATEPRICEEFFECTIVEDATE as decimal(6,0),",
				"          DATERELEASEJULIAN as decimal(6,0),",
				"          DTFORGLANDVOUCH1 as decimal(6,0),",
				"          CANCELDATE as decimal(6,0),",
				"          DATEINVOICEJULIAN as decimal(6,0),",
				"          ACTUALSHIPDATE as decimal(6,0),",
				"          SCHEDULEDPICKDATE as decimal(6,0),",
				"          DATETRANSACTIONJULIAN as decimal(6,0),",
				"          DATEREQUESTEDJULIAN as decimal(6,0),",
				"          ADDRESSNUMBERPARENT as integer,",
				"          ADDRESSNUMBERSHIPTO as integer,",
				"          ADDRESSNUMBER as integer,",
				"          CONTRACTSUPPLEMENTDISTRI as integer,",
				"          CONTRACTNUMBERDISTRIBUTI as string,",
				"          RELATEDPOSOLINENO as decimal(12,8),",
				"          RELATEDORDERTYPE as string,",
				"          RELATEDPOSONUMBER as string,",
				"          COMPANYKEYRELATED as string,",
				"          ORIGINALLINENUMBER as decimal(12,8),",
				"          ORIGINALORDERTYPE as string,",
				"          ORIGINALPOSONUMBER as string,",
				"          COMPANYKEYORIGINAL as string,",
				"          COMPANY as string,",
				"          COSTCENTER as string,",
				"          ORDERSUFFIX as string,",
				"          LINENUMBER as decimal(6,3),",
				"          ORDERTYPE as string,",
				"          {__IQ4BIS_PARTITIONKEY} as integer,",
				"          COMPANYKEYORDERNO as string,",
				"          DOCUMENTORDERINVOICEE as integer,",
				"          COMPANYKEYORDERNO_TRIM as string,",
				"          DOCUMENTORDERINVOICEE_TRIM as integer,",
				"          LINENUMBER_TRIM as decimal(6,3),",
				"          ORDERTYPE_TRIM as string,",
				"          DATETRANSACTIONJULIAN_DATE as date,",
				"          ACTUALSHIPDATE_DATE as date,",
				"          CANCELDATE_DATE as date,",
				"          DATEINVOICEJULIAN_DATE as date,",
				"          DATEORIGINALPROMISDE_DATE as date,",
				"          DATEPRICEEFFECTIVEDATE_DATE as date,",
				"          DATEPROMISEDSHIPJU_DATE as date,",
				"          DATERELEASE_DATE as date,",
				"          DATERELEASEJULIAN_DATE as date,",
				"          DATEREQUESTEDJULIAN_DATE as date,",
				"          DATEUPDATED_DATE as date,",
				"          DTFORGLANDVOUCH1_DATE as date,",
				"          SCHEDULEDPICKDATE_DATE as date,",
				"          USERRESERVEDDATE_DATE as date,",
				"          ACTUALSHIPDATE_YM as string,",
				"          CANCELDATE_YM as string,",
				"          DATEINVOICEJULIAN_YM as string,",
				"          DATEORIGINALPROMISDE_YM as string,",
				"          DATEPRICEEFFECTIVEDATE_YM as string,",
				"          DATEPROMISEDSHIPJU_YM as string,",
				"          DATERELEASE_YM as string,",
				"          DATERELEASEJULIAN_YM as string,",
				"          DATEREQUESTEDJULIAN_YM as string,",
				"          DATETRANSACTIONJULIAN_YM as string,",
				"          DATEUPDATED_YM as string,",
				"          DTFORGLANDVOUCH1_YM as string,",
				"          SCHEDULEDPICKDATE_YM as string,",
				"          USERRESERVEDDATE_YM as string,",
				"          SRC_DELETED_FLG as string,",
				"          LAST_UPDATED_TS as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> vSalesOrderDetailFile",
				"columnFilter, Product join(IDENTIFIER2NDITEM == PRODUCTID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinProduct",
				"JoinProduct, ADDRESSNUMBERSHIPTO join(ADDRESSNUMBERSHIPTO == CUSTOMERID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinShipCustomer",
				"dimCustomer select(mapColumn(",
				"          SK_DIMCUSTOMER,",
				"          CUSTOMERID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> ADDRESSNUMBERSHIPTO",
				"dimCustomer select(mapColumn(",
				"          SK_DIMCUSTOMER,",
				"          CUSTOMERID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> ADDRESSNUMBER",
				"JoinShipCustomer, ADDRESSNUMBER join(ADDRESSNUMBER == ADDRESSNUMBER@CUSTOMERID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinBillCustomer",
				"JoinBillCustomer derive(SALESORDERID = concat(toString(DOCUMENTORDERINVOICEE),ORDERTYPE,COMPANYKEYORDERNO),",
				"          SALESORDERLINEID = concat(toString(DOCUMENTORDERINVOICEE),ORDERTYPE,COMPANYKEYORDERNO,toString(LINENUMBER)),",
				"          TRANSACTIONPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATETRANSACTIONJULIAN_DATE),1),-1),",
				"          REQUESTPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATEREQUESTEDJULIAN_DATE),1),-1),",
				"          DELIVERYPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATERELEASEJULIAN_DATE),1),-1),",
				"          SHIPMENTPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATEPROMISEDSHIPJU_DATE),1),-1),",
				"          INVOICEPERIODDATEID = addMonths(addDays(lastDayOfMonth(DATEINVOICEJULIAN_DATE),1),-1),",
				"          GLPERIODDATEID = addMonths(addDays(lastDayOfMonth(DTFORGLANDVOUCH1_DATE),1),-1),",
				"          ISSAMPLE = iif(   UNITSQUANTITYSHIPPED > 0    && AMOUNTEXTENDEDPRICE == 0    && AMOUNTFOREIGNEXTPRICE == 0    , 1   , 0 ),",
				"          ISQUANTITYFIX = iif(   LINETYPE == 'N'    || LINETYPE == 'CB'    || LINETYPE == 'DB'   , 1   , 0 ),",
				"          each(match(right(name,11)=='JULIAN_DATE'||right(name,11)=='SHIPJU_DATE'), concat($$, '_awesome') = addMonths(addDays(lastDayOfMonth($$),1),-1))) ~> Transformation",
				"dimProduct select(mapColumn(",
				"          SK_DIMPRODUCT,",
				"          PRODUCTID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Product",
				"vSalesOrderDetailFile select(mapColumn(",
				"          each(match(in(['LAST_UPDATED_TS','SRC_DELETED_FLG','AMTPRICEPERUNIT2','AMOUNTEXTENDEDPRICE','DATETRANSACTIONJULIAN_DATE','AMOUNTEXTENDEDCOST','AMTFORPRICEPERUNIT','AMOUNTFOREIGNEXTPRICE','AMOUNTFOREIGNEXTCOST','UNITSTRANSACTIONQTY','UNITSPRIMARYQTYORDER','UNITSSECONDARYQTYOR','UNITSQUANTITYSHIPPED','LINETYPE','STATUSCODENEXT','HOLDORDERSCODE','UNITOFMEASUREASINPUT','UNITOFMEASUREPRIMARY','UNITOFMEASURESECONDARY','UNITOFMEASUREPRICING','CURRENCYCODEFROM','ADDRESSNUMBER','ADDRESSNUMBERSHIPTO','COSTCENTER','LOCATION','DTFORGLANDVOUCH1_DATE','DATERELEASEJULIAN_DATE','DATEPROMISEDSHIPJU_DATE','DATEINVOICEJULIAN_DATE','ATETRANSACTIONJULIAN_DATE','DATEREQUESTEDJULIAN_DATE','IDENTIFIER2NDITEM','ADDRESSNUMBERSHIPTO','ADDRESSNUMBER','DOCUMENTORDERINVOICEE','ORDERTYPE','COMPANYKEYORDERNO','LINENUMBER','AMOUNTFOREIGNEXTPRICE','AMOUNTEXTENDEDPRICE','UNITSQUANTITYSHIPPED','LINETYPE'],name)))",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> columnFilter",
				"Transformation select(mapColumn(",
				"          SK_DIMPRODUCT,",
				"          SK_SHIPTOCUSTOMERLEVELID = ADDRESSNUMBERSHIPTO@SK_DIMCUSTOMER,",
				"          SK_BILLTOCUSTOMERLEVELID = ADDRESSNUMBER@SK_DIMCUSTOMER,",
				"          SALESORDERID,",
				"          SALESORDERLINEID,",
				"          TRANSACTIONDATEID = DATETRANSACTIONJULIAN_DATE,",
				"          TRANSACTIONPERIODDATEID,",
				"          REQUESTDATEID = DATEREQUESTEDJULIAN_DATE,",
				"          REQUESTPERIODDATEID,",
				"          DELIVERYDATEID = DATERELEASEJULIAN_DATE,",
				"          DELIVERYPERIODDATEID,",
				"          SHIPMENTDATEID = DATEPROMISEDSHIPJU_DATE,",
				"          SHIPMENTPERIODDATEID,",
				"          INVOICEDATEID = DATEINVOICEJULIAN_DATE,",
				"          INVOICEPERIODDATEID,",
				"          GLDATEID = DTFORGLANDVOUCH1_DATE,",
				"          GLPERIODDATEID,",
				"          LINETYPEID = LINETYPE,",
				"          STATUSCODENEXTID = STATUSCODENEXT,",
				"          HOLDCODE = HOLDORDERSCODE,",
				"          ORDERUOMID = UNITOFMEASUREASINPUT,",
				"          PRIMARYUOMID = UNITOFMEASUREPRIMARY,",
				"          SECONDARYUOMID = UNITOFMEASURESECONDARY,",
				"          PRICINGUOMID = UNITOFMEASUREPRICING,",
				"          CURRENCYFOREIGNID = CURRENCYCODEFROM,",
				"          BILLTOCUSTOMERID = ADDRESSNUMBER,",
				"          SHIPTOCUSTOMERID = ADDRESSNUMBERSHIPTO,",
				"          BUSINESSUNITID = COSTCENTER,",
				"          LOCATIONID = LOCATION,",
				"          ISSAMPLE,",
				"          ISQUANTITYFIX,",
				"          UNITPRICEDOMESTIC = AMTPRICEPERUNIT2,",
				"          SALESPRICEDOMESTIC = AMOUNTEXTENDEDPRICE,",
				"          COGSDOMESTIC = AMOUNTEXTENDEDCOST,",
				"          UNITPRICEFOREIGN = AMTFORPRICEPERUNIT,",
				"          SALESPRICEFOREIGN = AMOUNTFOREIGNEXTPRICE,",
				"          COGSFOREIGN = AMOUNTFOREIGNEXTCOST,",
				"          ORDERQUANTITY = UNITSTRANSACTIONQTY,",
				"          ORDERQUANTITYPRIMARY = UNITSPRIMARYQTYORDER,",
				"          ORDERQUANTITYSECONDARY = UNITSSECONDARYQTYOR,",
				"          SHIPPEDQUANTITY = UNITSQUANTITYSHIPPED,",
				"          LAST_UPDATED_TS,",
				"          SRC_DELETED_FLG",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RenameColumnNames",
				"RenameColumnNames filter(!isNull(SK_DIMPRODUCT)&&!isNull(SK_SHIPTOCUSTOMERLEVELID)&&!isNull(SK_BILLTOCUSTOMERLEVELID)&&!isNull(SALESORDERID)&&!isNull(SALESORDERLINEID)) ~> filterAwayNulls",
				"filterAwayNulls sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     truncate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> fctSALESORDER"
			]
		}
	}
}