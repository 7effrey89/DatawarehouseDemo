{
	"name": "dimCustomer",
	"properties": {
		"folder": {
			"name": "JDEE1/Dimensions"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AzureTable1",
						"type": "DatasetReference"
					},
					"name": "vADDRESSBOOKMASTER"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureTable1",
						"type": "DatasetReference"
					},
					"name": "tmpDimCustomer"
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'WITH QUERYSNIPPET as (\\n    SELECT DISTINCT \\n     ADDRESSNUMBER AS CUSTOMERID\\n    ,NAMEALPHA CUSTOMER\\n    ,COSTCENTER COSTCENTERID\\n    ,ALTERNATEADDRESSKEY MNEMONICID\\n    ,CASE WHEN REPORTCODEADDBOOK017 <> \\'E\\' THEN 1 ELSE 0 END HIERARCHYFILTER\\n    ,CASE WHEN ADDRESSNUMBER NOT IN (\\'10240\\', \\'10430\\', \\'10440\\', \\'10730\\', \\'10740\\', \\'18830\\', \\'18835\\', \\'18837\\', \\'333333\\', \\'530813\\', \\'999999\\') THEN 1 ELSE 0 END SHIPTOFILTER\\n    ,CASE WHEN COALESCE (COSTCENTER,\\'\\') NOT IN  (\\'10440\\', \\'18940\\', \\'10240\\', \\'18830\\', \\'188910001\\') THEN 1 ELSE 0 END BUSINESSUNITFILTER\\n    ,CASE WHEN COALESCE (REPORTCODEADDBOOK015,\\'\\') <> \\'\\' AND REPORTCODEADDBOOK015 NOT LIKE \\'F%\\' AND SUBSTRING(REPORTCODEADDBOOK015,2,2) <> \\'99\\' THEN 1 ELSE 0 END SALESMANAGERFILTER\\n    FROM SRC_JDEE1.VADDRESSBOOKMASTER\\n    WHERE (ADDRESSTYPE1 LIKE \\'C%\\' OR ADDRESSTYPE1 IN (\\'FC\\', \\'IC\\') OR ADDRESSTYPE1 = \\'PBE\\' OR ADDRESSNUMBER = 536680) AND ADDRESSTYPE1 NOT IN (\\'CAP\\')\\n)\\nSELECT \\n    QUERYSNIPPET.*\\n    , ABM.ADDRESSTYPE1 AS SEARCHTYPEID\\n    , UDCST.DESCRIPTION001 AS SEARCHTYPE\\n    , ABM.REPORTCODEADDBOOK004 AS TERRITORYID\\n    , UDC13.DESCRIPTION001 AS PBCSCUSTOMERID\\n    , ABM.REPORTCODEADDBOOK017 AS HIERARCHYCHECKID\\n    , UDC17.DESCRIPTION001 AS HIERARCHYCHECK\\n    , UDC12.DESCRIPTION01002 AS MANUFACTURINGTYPE\\n    , UDC12.SPECIALHANDLINGCODE AS CUSTOMERCLASS\\n    , UDC13.DESCRIPTION01002 AS SALESTYPE\\n    , UDC13.SPECIALHANDLINGCODE AS CONTRACTCODE\\n    , ABM.REPORTCODEADDBOOK014 AS CUSTOMERTYPEID\\n    , UDC14.DESCRIPTION001 AS CUSTOMERTYPE\\n    ,case when ABM.REPORTCODEADDBOOK014 = \\' \\' then \\'-1\\' else REPORTCODEADDBOOK014 end AS CUSTOMERCODEID\\n    , UDC13.DESCRIPTION001 AS CUSTOMERCODE\\n    , case when ABM.REPORTCODEADDBOOK015 = \\' \\' then \\'-1\\' else REPORTCODEADDBOOK015 end AS SALESMANAGERID\\n    , UDC15.DESCRIPTION001 AS SALESMANAGER\\n    , UDC15.DESCRIPTION01002 AS SALESMANAGERREGION\\n    ,case when ABM.REPORTCODEADDBOOK014 = \\' \\' then \\'-1\\' else REPORTCODEADDBOOK014 end AS CUSTOMERAGGRLEVELID\\n    ,case when ABM.REPORTCODEADDBOOK014 = \\' \\'  then \\'-1\\' else UDC13.DESCRIPTION001 end AS CUSTOMERAGGRLEVEL\\n    , case when ABM.REPORTCODEADDBOOK014 = \\' \\' then \\'-1\\' else REPORTCODEADDBOOK014 end AS PLANNINGLEVELID\\n    ,case when ABM.REPORTCODEADDBOOK014 = \\' \\'  then \\'-1\\' else UDC13.DESCRIPTION001 end as PLANNINGLEVEL\\n    ,case when ABM.REPORTCODEADDBOOK012 = \\' \\' then \\'-1\\' else REPORTCODEADDBOOK012 end as CORPORATECODEID\\n    \\n    , UDC12.DESCRIPTION001 AS CORPORATECODE\\n    ,CASE WHEN CONCAT(HIERARCHYFILTER,SHIPTOFILTER) = 11 THEN 1 ELSE 0 END AS ACTUALSFILTER\\n    ,CASE WHEN CONCAT(HIERARCHYFILTER,SHIPTOFILTER,BUSINESSUNITFILTER,SALESMANAGERFILTER) = 1111 THEN 1 ELSE 0 END PLANNINGFILTER\\n    ,ABM.LAST_UPDATED_TS\\n    ,ABM.SRC_DELETED_FLG\\nFROM QUERYSNIPPET\\nLEFT JOIN SRC_JDEE1.VADDRESSBOOKMASTER as ABM ON QUERYSNIPPET.CUSTOMERID = ABM.ADDRESSNUMBER \\nLEFT JOIN  SRC_JDEE1.VUSERDEFINEDCODEVALUES UDCST on ABM.ADDRESSTYPE1 = UDCST.USERDEFINEDCODE and UDCST.PRODUCTCODE = \\'01\\' and UDCST.USERDEFINEDCODES = \\'ST\\'\\n--LEFT JOIN ADDRESSBOOKMASTER as U13 ON QUERYSNIPPET.CUSTOMERID = U13.ADDRESSNUMBER \\nLEFT JOIN  SRC_JDEE1.VUSERDEFINEDCODEVALUES UDC13 on ABM.REPORTCODEADDBOOK014 = UDC13.USERDEFINEDCODE and UDC13.PRODUCTCODE = \\'01\\' and UDC13.USERDEFINEDCODES = \\'13\\'\\n--LEFT JOIN ADDRESSBOOKMASTER as U17 ON QUERYSNIPPET.CUSTOMERID = U17.ADDRESSNUMBER \\nLEFT JOIN  SRC_JDEE1.VUSERDEFINEDCODEVALUES UDC17 on ABM.REPORTCODEADDBOOK017 = UDC17.USERDEFINEDCODE and UDC17.PRODUCTCODE = \\'01\\' and UDC17.USERDEFINEDCODES = \\'17\\'\\n--LEFT JOIN ADDRESSBOOKMASTER as U12 ON QUERYSNIPPET.CUSTOMERID = U12.ADDRESSNUMBER \\nLEFT JOIN  SRC_JDEE1.VUSERDEFINEDCODEVALUES AS UDC12 on ABM.REPORTCODEADDBOOK012 = UDC12.USERDEFINEDCODE and UDC12.PRODUCTCODE = \\'01\\' and UDC12.USERDEFINEDCODES = \\'12\\'\\n--LEFT JOIN ADDRESSBOOKMASTER as U14 ON QUERYSNIPPET.CUSTOMERID = U14.ADDRESSNUMBER \\nLEFT JOIN  SRC_JDEE1.VUSERDEFINEDCODEVALUES UDC14 on ABM.REPORTCODEADDBOOK014 = UDC14.USERDEFINEDCODE and UDC14.PRODUCTCODE = \\'01\\' and UDC14.USERDEFINEDCODES = \\'14\\'\\n--LEFT JOIN ADDRESSBOOKMASTER as U15 ON QUERYSNIPPET.CUSTOMERID = U15.ADDRESSNUMBER \\nLEFT JOIN  SRC_JDEE1.VUSERDEFINEDCODEVALUES AS UDC15 on ABM.REPORTCODEADDBOOK015 = UDC15.USERDEFINEDCODE and UDC15.PRODUCTCODE = \\'01\\' and UDC15.USERDEFINEDCODES = \\'15\\'',",
				"     format: 'query') ~> vADDRESSBOOKMASTER",
				"vADDRESSBOOKMASTER sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     truncate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> tmpDimCustomer"
			]
		}
	}
}